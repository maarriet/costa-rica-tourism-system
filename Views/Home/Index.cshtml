@model Sistema_GuiaLocal_Turismo.ViewModels.UserDashboardViewModel
@{
    ViewData["Title"] = "Portal de Usuario - Turismo Costa Rica";
}

@section Styles {
    <link href="/css/styles.css" rel="stylesheet" />
}

<!-- Header Compacto para Usuario -->
<div class="compact-header">
    <div class="header-content">
        <div class="header-main">
            <h1><i class="fas fa-user"></i> Bienvenido, @Model.User.FirstName</h1>
            <p>Descubre y reserva los mejores lugares de Costa Rica</p>
        </div>
        <div class="header-stats-mini">
            <div class="stat-mini">
                <i class="fas fa-map-marker-alt"></i>
                <span>@Model.AvailablePlaces.Count Lugares</span>
            </div>
            <div class="stat-mini">
                <i class="fas fa-calendar-check"></i>
                <span>@Model.UserReservations.Count Reservas</span>
            </div>
            <div class="stat-mini">
                <i class="fas fa-tags"></i>
                <span>@Model.Categories.Count Categorías</span>
            </div>
        </div>
    </div>
</div>

<!-- Navegación para Usuario -->
<nav>
    <div class="nav-container">
        <div class="logo">
            <i class="fas fa-map-marked-alt"></i> Turismo CR
        </div>
        <ul class="nav-links">
            <li><a href="@Url.Action("Index", "Home")" class="active"><i class="fas fa-home"></i> Inicio</a></li>
            <li><a href="@Url.Action("Places", "Home")"><i class="fas fa-map-marker-alt"></i> Lugares</a></li>
            <li><a href="@Url.Action("MyReservations", "Home")"><i class="fas fa-calendar-check"></i> Mis Reservas</a></li>
            <li>
                <form asp-controller="Account" asp-action="Logout" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-outline-light btn-sm">
                        <i class="fas fa-sign-out-alt"></i> Salir
                    </button>
                </form>
            </li>
        </ul>
    </div>
</nav>

<div class="container">
    <!-- Acceso Rápido -->
    <div class="quick-access-section">
        <h3><i class="fas fa-rocket"></i> Acceso Rápido</h3>
        <div class="quick-access-grid">
            <a href="@Url.Action("Places", "Home")" class="quick-access-card">
                <div class="quick-icon bg-primary">
                    <i class="fas fa-search"></i>
                </div>
                <div class="quick-info">
                    <h4>Explorar Lugares</h4>
                    <p>Descubre destinos increíbles</p>
                </div>
                <i class="fas fa-arrow-right"></i>
            </a>

            <a href="@Url.Action("MyReservations", "Home")" class="quick-access-card">
                <div class="quick-icon bg-success">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="quick-info">
                    <h4>Mis Reservas</h4>
                    <p>Gestiona tus reservaciones</p>
                </div>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>

    <!-- Categorías Populares -->
    <section class="section">
        <div class="section-header">
            <h2><i class="fas fa-tags"></i> Categorías Populares</h2>
            <p>Explora por tipo de experiencia</p>
        </div>
        
        <div class="categories-grid">
            @foreach (var category in Model.Categories)
            {
                <div class="category-card">
                    <div class="category-header">
                        <div class="category-icon" style="background-color: @category.Color">
                            <i class="@category.Icon"></i>
                        </div>
                        <div class="category-info">
                            <h3>@category.Name</h3>
                            <p>@category.Description</p>
                        </div>
                        <div class="category-actions">
                            <a href="@Url.Action("Places", "Home", new { categoryId = category.Id })" 
                               class="btn btn-primary btn-sm">
                                <i class="fas fa-eye"></i> Ver
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </section>

    <!-- Lugares Destacados -->
    <section class="section">
        <div class="section-header">
            <h2><i class="fas fa-star"></i> Lugares Destacados</h2>
            <p>Los destinos más populares</p>
        </div>
        
        <div class="grid">
            @foreach (var place in Model.AvailablePlaces)
            {
                <div class="card">
                    <div class="card-icon">
                        <i class="@place.Category.Icon"></i>
                    </div>
                    <h3>@place.Name</h3>
                    <p>@place.Description</p>
                    <div class="place-info">
                        <strong>Ubicación:</strong> @place.Location<br>
                        <strong>Precio:</strong> <span class="currency">$@place.Price.ToString("F2")</span><br>
                        <strong>Capacidad:</strong> @place.Capacity personas
                    </div>
                    <div class="mt-3">
                        <a href="@Url.Action("PlaceDetails", "Home", new { id = place.Id })" 
                           class="btn btn-primary">
                            <i class="fas fa-info-circle"></i> Ver Detalles
                        </a>
                    </div>
                </div>
            }
        </div>
    </section>

    <!-- Mis Reservas Recientes -->
    @if (Model.UserReservations.Any())
    {
        <section class="section">
            <div class="section-header">
                <h2><i class="fas fa-history"></i> Mis Reservas Recientes</h2>
                <a href="@Url.Action("MyReservations", "Home")" class="btn btn-outline-primary">Ver Todas</a>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Lugar</th>
                            <th>Fechas</th>
                            <th>Estado</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var reservation in Model.UserReservations)
                        {
                            <tr>
                                <td>
                                    <strong>@reservation.Place.Name</strong><br>
                                    <small>@reservation.Place.Location</small>
                                </td>
                                <td>
                                    <strong>@reservation.StartDate.ToString("dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture)</strong>
                                    @if (reservation.EndDate.HasValue)
                                    {
                                        <small>hasta @reservation.EndDate.Value.Date.ToString("dd/MM/yyyy")</small>
                                    }
                                </td>
                                <td>
                                    <span class="badge badge-success">@reservation.Status</span>
                                </td>
                                <td>
                                    <span class="currency">$@reservation.TotalAmount.ToString("F2")</span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </section>
    }
</div>